# 오늘의 봉사

회중 봉사 일정 관리 시스템. PHP + MySQL 기반의 메인 앱과 4개의 독립 모듈로 구성됩니다.

## 모듈 구성

```
today_service/
├── (root)   메인 앱 — 봉사 배정, 구역 관리, 회원 관리
├── c/       봉사인도 월별 캘린더 (JSON 스토리지)
├── s/       평일집회 프로그램 / 공개강연 계획표 / 청소·마이크·안내인 계획표
├── m/       호별봉사 짝배정 현황 및 전도인 기록
└── t/       프레젠테이션 타이머
```

### 메인 앱 (root)

- 오늘의 봉사 배정 대시보드
- 구역 배정/관리 및 구역 쪽지(채팅) 기능
- 회원·관리자 관리
- 세션 기반 인증 (60분 만료)

### 봉사인도 캘린더 (`c/`)

- 월별 달력에 날짜별 메모·이름 입력
- JSON 파일 스토리지 + 자동 백업
- 공휴일 자동 표시
- iframe 삽입용 읽기 전용 뷰 제공

### 프로그램 관리 (`s/`)

3개의 독립 모듈 포함:

| 모듈 | 파일 | 설명 |
|------|------|------|
| 평일집회 프로그램 | `index`, `api`, `view`, `print` | 주간 프로그램 관리 (보물/봉사/생활) |
| 공개강연 계획표 | `talk_*` | 연사/사회/낭독/기도 배정 |
| 청소·마이크·안내인 | `duty_*` | 월별 청소집단, 마이크, 안내인, 연사음료 배정 |

각 모듈은 `*_view.php`(읽기) / `*_admin.php`(편집) / `*_api.php`(API) / `*_print.php`(인쇄) 구조.

### 호별봉사 기록 (`m/`)

- 전도인 기록 및 추천짝 배정
- 구역배정(guide_assign_step) 연동

### 타이머 (`t/`)

- 프레젠테이션 타이머 + 음악 재생
- 요일별 자동 시작 (일요일 13:00, 평일 19:30 완료 기준)

## 요구 사항

- PHP 7.3+ 또는 8.3+ (캘린더 모듈은 8.1+ 필요)
- MariaDB 5.5+ 또는 10.6+

## 설치

### 1. 설정 파일 생성

`config_sample.php`를 복사하여 `config_custom.php` 생성 후 DB 정보 입력:

```bash
cp config_sample.php config_custom.php
```

### 2. DB 설치

브라우저에서 `update.php` 접속 후 안내에 따라 설치 진행.

- **신규 설치**: 테이블 생성 + 관리자 계정 등록
- **DB 업데이트**: 기존 DB 스키마 마이그레이션 (버전별 ALTER TABLE)
- **관리자 추가**: 비밀번호 분실 등으로 계정 추가 시 사용

### 3. 하위 모듈 설정

**캘린더 (`c/`):**
```bash
cd c/
mkdir -p storage/backups
chmod 775 storage storage/backups
```

**프로그램·청소 (`s/`):**
```bash
cd s/
mkdir -p data
chmod 775 data
```

## 로컬 개발

```bash
# PHP 내장 서버
php -S localhost:9000

# 브라우저 접속
open http://localhost:9000
```

## 버전

현재 upstream 버전: **v2.5.14**

## 라이선스

MIT License
